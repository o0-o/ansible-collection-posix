# vim: ts=2:sw=2:sts=2:et:ft=yaml.ansible
# -*- mode: yaml; yaml-indent-offset: 2; indent-tabs-mode: nil; -*-
---
# GNU General Public License v3.0+
# SPDX-License-Identifier: GPL-3.0-or-later
# (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)
#
# Copyright (c) 2025 o√ò.o (@o0-o)
#
# This file is part of the o0_o.posix Ansible Collection.

- name: Run with default gather_subset (should equal 'all')
  o0_o.posix.facts:
  check_mode: true

- name: Assert default run returns both o0_os and o0_hardware
  assert:
    that:
      - o0_os['kernel']['name'] is string
      - o0_hardware['cpu']['architecture'] is string

- name: "Run with gather_subset=['kernel']"
  o0_o.posix.facts:
    gather_subset: ['kernel']

- name: Assert only o0_os.kernel returned
  assert:
    that:
      - o0_os['kernel']['name'] is defined
      - o0_hardware is not defined

- name: "Run with gather_subset=['arch']"
  o0_o.posix.facts:
    gather_subset: ['arch']

- name: Assert only o0_hardware.cpu returned
  assert:
    that:
      - o0_hardware['cpu']['architecture'] is defined
      - o0_os is not defined

- name: "Run with gather_subset=['!kernel']"
  o0_o.posix.facts:
    gather_subset: ['!kernel']

- name: Assert kernel facts excluded, hardware present
  assert:
    that:
      - o0_os is not defined
      - o0_hardware['cpu']['architecture'] is defined

- name: "Run with gather_subset=['!all']"
  o0_o.posix.facts:
    gather_subset: ['!all']
  register: facts_empty_reg

- name: Assert no facts returned
  assert:
    that:
      - facts_empty_reg['ansible_facts'] == {}
